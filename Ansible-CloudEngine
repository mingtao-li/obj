- name: CloudEngine command test
  hosts: CE_6851
  connection: local
  gather_facts: no
  vars_files:
      - creds.yaml
  vars:
    cli:
      host: "{{ inventory_hostname }}"
      port: "{{ ansible_ssh_port }}"
      username: "{{ username }}"
      password: "{{ password }}"
      transport: cli

  tasks:
#  - name: "Run display version on remote devices"
#    ce_command:
#      commands: display version
#      wait_for: result[0] contains HUAWEI
#      provider: "{{ cli }}"

  - name: Config a vpn install named vpna, description is test
    ce_vrf:
      vrf: vpna
      description: test
      state: present
      provider: "{{ cli }}"


#  - name: "Configure acl named for-nms-vty"
#    ce_config:
#      lines:
#        - description for-nms-vty
#        - rule 5 permit source 172.16.0.0 0.15.255.255
#        - rule 10 permit source 192.168.0.0 0.0.255.255
#        - rule 15 permit source 10.0.0.0 0.255.255.255
#        - rule 20 permit vpn-instance IBMGT source 172.16.0.0 0.15.255.255
#        - rule 25 permit vpn-instance IBMGT source 192.168.0.0 0.0.255.255
#        - rule 30 permit vpn-instance IBMGT source 10.0.0.0 0.255.255.255
#        - rule 35 permit source 120.132.1.224 0.0.0.31
#        - rule 1000 deny
#      parents: acl 2001
#      before: undo acl 2001
#      replace: block
#      provider: "{{ cli }}"
